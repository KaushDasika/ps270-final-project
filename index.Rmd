---
title: "PS270 Final Project"
author: "Kaushal Dasika"
description: "Examining the relationship between stock market performance, approval ratings, and re-election outcomes of incumbent U.S. presidents"
output:
  distill::distill_article:
    self_contained: false
---


How are the approval ratings of incumbent U.S. presidents running for the second term related to the stock market performance during their first term and did they win the election? 

The relationship between economic performance and electoral outcomes has long been a point of discussion among political scientists and this research aims to study the connection between the approval ratings of incumbent U.S. presidents running for a second term and the stock market performance during their first term, specifically the S&P 500.

This hypothesis sheds light on how voters respond to economic outcomes under incumbent leadership. If economic growth positively correlates with approval ratings, it suggests that the voters reward incumbents for economic success, potentially tipping the scales in a close election. The use of the S&P 500 index provides a quantitative and widely recognized measure of economic performance, while approval ratings offer a direct lens into public sentiment, as pre-election polls may be more biased since voters also follow party lines while casting their ballots. Understanding this relationship deepens our knowledge of how economic indicators influence elections.  A pattern in the data that would prove my hypothesis is if positive and negative changes in the S&P translate to approval ratings. I will also analyze the relationship specifically based on party and election results to see if the correlation is stronger or weaker based on those factors.






```{r}
library(readr)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(knitr)
knitr::opts_chunk$set(echo = TRUE, fig.align = 'center', fig.width = 8, fig.height = 6)

#Approval Ratings Data
presApproval <- read_csv("data/PresApproval.csv")

presApproval$Date <- dmy(paste("01", presApproval$Date)) 
presApproval$Date <- format(presApproval$Date, "%m/%Y")

#S&P 500 Data
SPObama <- read_csv("data/ObamaSP500.csv")
SPBush2 <- read_csv("data/Bush2SP500.csv")
SPClinton <- read_csv("data/ClintonSP500.csv")
SPBush1 <- read_csv("data/Bush1SP500.csv")
SPCarter <- read_csv("data/CarterSP500.csv")
 

SPObama$Date <- mdy(SPObama$Date)           
SPObama$Date <- format(SPObama$Date, "%m/%Y")

SPBush2$Date <- mdy(SPBush2$Date)           
SPBush2$Date <- format(SPBush2$Date, "%m/%Y")

SPClinton$Date <- mdy(SPClinton$Date)           
SPClinton$Date <- format(SPClinton$Date, "%m/%Y")

SPBush1$Date <- mdy(SPBush1$Date)           
SPBush1$Date <- format(SPBush1$Date, "%m/%Y")

SPCarter$Date <- mdy(SPCarter$Date)           
SPCarter$Date <- format(SPCarter$Date, "%m/%Y")


#Merged Dataset
SPTotal <- bind_rows(SPObama, SPBush2, SPClinton, SPBush1, SPCarter)

resultTotal <- inner_join(presApproval, SPTotal, by = "Date")

resultTotal <- resultTotal |>
  mutate(`Change %` = as.numeric(gsub("%", "", `Change %`)))

# Net Approval vs S&P 500 for all
plotAll <- ggplot(data = resultTotal, aes(x = `Change %`, y = `Change`)) +
  geom_point(size = 3, color = "black", alpha = 0.8) + 
  geom_smooth(method = "lm", se = TRUE, color = "blue", size = 1, linetype = "dashed") +
  labs(
    title = "Approval Change vs. S&P 500 Change (%)",
    x = "S&P 500 Change (%)",
    y = "Approval Change",
    caption = "Data Sources: American Presidency Project (Approval Ratings), S&P 500"
  ) +
  scale_color_viridis_c() +
  theme_minimal(base_size = 14) +
  theme(
    panel.grid.major = element_line(color = "gray80"),
    panel.grid.minor = element_line(color = "gray90"),
    plot.title = element_text(face = "bold", hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    plot.caption = element_text(hjust = 1)
  )
```


```{r plot-all, echo=FALSE, fig.width=8, fig.height=6, fig.align='center'}
print(plotAll)
```

```{r}
all <- lm(Change ~ `Change %`, data = resultTotal)

modelsummary::modelsummary(
  all,
  statistic = c("Standard Error. = {std.error}", 
                "p-value = {p.value}"),
  gof_map = c("nobs", "r.squared", "adj.r.squared"),
  coef_rename = c("(Intercept)" = "Approval Change")
)
```



```{r}
# Democrats

SPDems <- bind_rows(SPObama, SPClinton, SPCarter)

resultDems <- inner_join(presApproval, SPDems, by = "Date")

resultDems <- resultDems |>
  mutate(`Change %` = as.numeric(gsub("%", "", `Change %`)))

#Graph
plotDems <- ggplot(data = resultDems, aes(x = `Change %`, y = `Change`)) +
  geom_point(size = 3, color = "black", alpha = 0.8) + 
  geom_smooth(method = "lm", se = TRUE, color = "blue", size = 1, linetype = "dashed") +
  labs(
    title = "Approval Change vs. S&P 500 Change (%) [Democrat Incumbent]",
    x = "S&P 500 Change (%)",
    y = "Approval Change",
    caption = "Data Sources: American Presidency Project (Approval Ratings), S&P 500"
  ) +
  scale_color_viridis_c() +
  theme_minimal(base_size = 14) +
  theme(
    panel.grid.major = element_line(color = "gray80"),
    panel.grid.minor = element_line(color = "gray90"),
    plot.title = element_text(face = "bold", hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    plot.caption = element_text(hjust = 1)
  )
```

```{r plot-dems, echo=FALSE, fig.width=8, fig.height=6, fig.align='center'}
print(plotDems)
```

```{r}
dems <- lm(Change ~ `Change %`, data = resultDems)

modelsummary::modelsummary(
  dems,
  statistic = c("Standard Error. = {std.error}", 
                "p-value = {p.value}"),
  gof_map = c("nobs", "r.squared", "adj.r.squared"),
  coef_rename = c("(Intercept)" = "Approval Change")
)
```



```{r}
# Republicans

SPRep <- bind_rows(SPBush1, SPBush2)

resultRep <- inner_join(presApproval, SPRep, by = "Date")

resultRep <- resultRep |>
  mutate(`Change %` = as.numeric(gsub("%", "", `Change %`)))

#Graph
plotRep <- ggplot(data = resultRep, aes(x = `Change %`, y = `Change`)) +
  geom_point(size = 3, color = "black", alpha = 0.8) + 
  geom_smooth(method = "lm", se = TRUE, color = "blue", size = 1, linetype = "dashed") +
  labs(
    title = "Approval Change vs. S&P 500 Change (%) [Republican Incumbent]",
    x = "S&P 500 Change (%)",
    y = "Approval Change",
    caption = "Data Sources: American Presidency Project (Approval Ratings), S&P 500"
  ) +
  scale_color_viridis_c() +
  theme_minimal(base_size = 14) +
  theme(
    panel.grid.major = element_line(color = "gray80"),
    panel.grid.minor = element_line(color = "gray90"),
    plot.title = element_text(face = "bold", hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    plot.caption = element_text(hjust = 1)
  )
```

```{r plot-rep, echo=FALSE, fig.width=8, fig.height=6, fig.align='center'}
print(plotRep)
```

```{r}
reps <- lm(Change ~ `Change %`, data = resultRep)

modelsummary::modelsummary(
  reps,
  statistic = c("Standard Error. = {std.error}", 
                "p-value = {p.value}"),
  gof_map = c("nobs", "r.squared", "adj.r.squared"),
  coef_rename = c("(Intercept)" = "Approval Change")
)

```



```{r}
# Election Result = Win

SPWin <- bind_rows(SPObama, SPBush1, SPClinton)

resultWin <- inner_join(presApproval, SPWin, by = "Date")

resultWin <- resultWin |>
  mutate(`Change %` = as.numeric(gsub("%", "", `Change %`)))

#Graph
plotWin <- ggplot(data = resultWin, aes(x = `Change %`, y = `Change`)) +
  geom_point(size = 3, color = "black", alpha = 0.8) + 
  geom_smooth(method = "lm", se = TRUE, color = "blue", size = 1, linetype = "dashed") +
  labs(
    title = "Approval Change vs. S&P 500 Change (%) [Won Re-election]",
    x = "S&P 500 Change (%)",
    y = "Approval Change",
    caption = "Data Sources: American Presidency Project (Approval Ratings), S&P 500"
  ) +
  scale_color_viridis_c() +
  theme_minimal(base_size = 14) +
  theme(
    panel.grid.major = element_line(color = "gray80"),
    panel.grid.minor = element_line(color = "gray90"),
    plot.title = element_text(face = "bold", hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    plot.caption = element_text(hjust = 1)
  )

```

```{r plot-win, echo=FALSE, fig.width=8, fig.height=6, fig.align='center'}
print(plotWin)
```


```{r}
win <- lm(Change ~ `Change %`, data = resultWin)

modelsummary::modelsummary(
  reps,
  statistic = c("Standard Error. = {std.error}", 
                "p-value = {p.value}"),
  gof_map = c("nobs", "r.squared", "adj.r.squared"),
  coef_rename = c("(Intercept)" = "Approval Change")
)
```







```{r}
# Election Result = Loss

SPLoss <- bind_rows(SPBush2, SPCarter)

resultLoss <- inner_join(presApproval, SPLoss, by = "Date")

resultLoss <- resultLoss |>
  mutate(`Change %` = as.numeric(gsub("%", "", `Change %`)))

#Graph
plotLoss <- ggplot(data = resultLoss, aes(x = `Change %`, y = `Change`)) +
  geom_point(size = 3, color = "black", alpha = 0.8) + 
  geom_smooth(method = "lm", se = TRUE, color = "blue", size = 1, linetype = "dashed") +
  labs(
    title = "Approval Change vs. S&P 500 Change (%) [Lost Re-election]",
    x = "S&P 500 Change (%)",
    y = "Approval Change",
    caption = "Data Sources: American Presidency Project (Approval Ratings), S&P 500"
  ) +
  scale_color_viridis_c() +
  theme_minimal(base_size = 14) +
  theme(
    panel.grid.major = element_line(color = "gray80"),
    panel.grid.minor = element_line(color = "gray90"),
    plot.title = element_text(face = "bold", hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    plot.caption = element_text(hjust = 1)
  )
```

```{r plot-loss, echo=FALSE, fig.width=8, fig.height=6, fig.align='center'}
print(plotLoss)
```

```{r}
loss <- lm(Change ~ `Change %`, data = resultLoss)

modelsummary::modelsummary(
  reps,
  statistic = c("Standard Error. = {std.error}", 
                "p-value = {p.value}"),
  gof_map = c("nobs", "r.squared", "adj.r.squared"),
  coef_rename = c("(Intercept)" = "Approval Change")
)
```

